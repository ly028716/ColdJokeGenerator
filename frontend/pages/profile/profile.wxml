<view class="container">
  <!-- 顶部标题栏 -->
  <view class="header">
    <text class="header-title">个人中心</text>
  </view>

  <!-- 用户信息卡片 -->
  <view class="user-card">
    <view class="user-info">
      <view class="avatar-container" bindtap="getUserProfile" wx:if="{{!userInfo}}">
        <view class="avatar-placeholder">
          <text class="avatar-icon">👤</text>
        </view>
      </view>
      
      <view class="avatar-container" wx:if="{{userInfo}}">
        <image class="avatar" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
      </view>
      
      <view class="user-details">
        <text class="username" wx:if="{{userInfo}}">{{userInfo.nickName}}</text>
        <text class="username" wx:else>点击登录</text>
        <text class="user-desc">使用第 {{userStats.joinDays}} 天</text>
      </view>
    </view>
    
    <!-- 统计信息 -->
    <view class="stats-row">
      <view class="stat-item">
        <text class="stat-number">{{userStats.totalGenerated}}</text>
        <text class="stat-label">生成</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{userStats.totalViewed}}</text>
        <text class="stat-label">浏览</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{userStats.totalFavorited}}</text>
        <text class="stat-label">收藏</text>
      </view>
    </view>
  </view>

  <!-- 功能菜单 -->
  <view class="menu-section">
    <view 
      class="menu-item"
      wx:for="{{menuItems}}" 
      wx:key="id"
      data-item="{{item}}"
      bindtap="onMenuItemTap">
      <text class="menu-icon">{{item.icon}}</text>
      <text class="menu-title">{{item.title}}</text>
      <text class="menu-arrow">›</text>
    </view>
  </view>

  <!-- 其他操作 -->
  <view class="action-section">
    <view class="action-item" bindtap="clearCache">
      <text class="action-icon">🗑️</text>
      <text class="action-text">清除缓存</text>
    </view>
    <view class="action-item" bindtap="checkUpdate">
      <text class="action-icon">🔄</text>
      <text class="action-text">检查更新</text>
    </view>
    <view class="action-item" bindtap="contactService">
      <text class="action-icon">📞</text>
      <text class="action-text">联系客服</text>
    </view>
    <button class="action-item share-btn" open-type="share">
      <text class="action-icon">📤</text>
      <text class="action-text">分享应用</text>
    </button>
  </view>

  <!-- 版本信息 -->
  <view class="version-info">
    <text class="version-text">版本 {{appInfo.version}}</text>
  </view>

</view>

<!-- 设置面板 -->
<view class="modal-overlay" wx:if="{{showSettingsPanel}}" bindtap="hideSettings">
  <view class="modal-content settings-panel" catchtap="">
    <view class="modal-header">
      <text class="modal-title">偏好设置</text>
      <view class="modal-close" bindtap="hideSettings">×</view>
    </view>
    
    <scroll-view class="modal-body" scroll-y>
      
      <!-- 生成设置 -->
      <view class="setting-group">
        <text class="group-title">生成设置</text>
        
        <view class="setting-item">
          <text class="setting-label">笑话长度</text>
          <picker 
            mode="selector" 
            range="{{constants.JOKE_LENGTHS}}" 
            range-key="name"
            value="{{preferences.length}}"
            bindchange="onLengthChange">
            <view class="picker-display">
              <text>{{preferences.length}}</text>
              <text class="picker-arrow">▼</text>
            </view>
          </picker>
        </view>
        
        <view class="setting-item">
          <text class="setting-label">创意度 ({{preferences.temperature}})</text>
          <slider 
            min="0.1" 
            max="2.0" 
            step="0.1" 
            value="{{preferences.temperature}}"
            bindchange="onTemperatureChange"
            activeColor="#4A90E2"
            block-color="#4A90E2"
            class="temperature-slider">
          </slider>
        </view>
      </view>
      
      <!-- 界面设置 -->
      <view class="setting-group">
        <text class="group-title">界面设置</text>
        
        <view class="setting-item">
          <text class="setting-label">字体大小</text>
          <picker 
            mode="selector" 
            range="{{constants.FONT_SIZES}}" 
            range-key="name"
            value="{{preferences.fontSize}}"
            bindchange="onFontSizeChange">
            <view class="picker-display">
              <text>{{preferences.fontSize}}</text>
              <text class="picker-arrow">▼</text>
            </view>
          </picker>
        </view>
        
        <view class="setting-item">
          <view class="setting-info">
            <text class="setting-label">深色模式</text>
            <text class="setting-desc">暂未支持</text>
          </view>
          <switch 
            checked="{{preferences.darkMode}}" 
            disabled="{{true}}"
            data-key="darkMode" 
            data-value="{{!preferences.darkMode}}"
            bindchange="onPreferenceChange">
          </switch>
        </view>
      </view>
      
      <!-- 行为设置 -->
      <view class="setting-group">
        <text class="group-title">行为设置</text>
        
        <view class="setting-item">
          <view class="setting-info">
            <text class="setting-label">自动保存</text>
            <text class="setting-desc">自动保存浏览历史</text>
          </view>
          <switch 
            checked="{{preferences.autoSave}}" 
            data-key="autoSave" 
            data-value="{{!preferences.autoSave}}"
            bindchange="onPreferenceChange">
          </switch>
        </view>
        
        <view class="setting-item">
          <view class="setting-info">
            <text class="setting-label">震动反馈</text>
            <text class="setting-desc">操作时提供震动反馈</text>
          </view>
          <switch 
            checked="{{preferences.vibration}}" 
            data-key="vibration" 
            data-value="{{!preferences.vibration}}"
            bindchange="onPreferenceChange">
          </switch>
        </view>
      </view>
      
    </scroll-view>
  </view>
</view>

<!-- 反馈面板 -->
<view class="modal-overlay" wx:if="{{showFeedbackPanel}}" bindtap="hideFeedback">
  <view class="modal-content feedback-panel" catchtap="">
    <view class="modal-header">
      <text class="modal-title">意见反馈</text>
      <view class="modal-close" bindtap="hideFeedback">×</view>
    </view>
    
    <view class="modal-body" catchtap="">
      <view class="feedback-type">
        <text class="form-label">反馈类型</text>
        <picker 
          mode="selector" 
          range="{{feedbackTypes}}" 
          range-key="label"
          bindchange="onFeedbackTypeChange">
          <view class="picker-display">
            <text>{{getFeedbackTypeLabel(feedbackType)}}</text>
            <text class="picker-arrow">▼</text>
          </view>
        </picker>
      </view>
      
      <view class="feedback-content">
        <text class="form-label">反馈内容</text>
        <textarea 
          class="feedback-textarea"
          placeholder="请详细描述您的问题或建议..."
          value="{{feedbackContent}}"
          bindinput="onFeedbackInput"
          maxlength="500"
          show-confirm-bar="{{false}}">
        </textarea>
        <text class="char-count">{{feedbackContent.length}}/500</text>
      </view>
    </view>
    
    <view class="modal-footer">
      <view class="footer-btn cancel-btn" bindtap="hideFeedback">取消</view>
      <view class="footer-btn submit-btn" bindtap="submitFeedback">提交</view>
    </view>
  </view>
</view>

<!-- 关于面板 -->
<view class="modal-overlay" wx:if="{{showAboutPanel}}" bindtap="hideAbout">
  <view class="modal-content about-panel" catchtap="">
    <view class="modal-header">
      <text class="modal-title">关于我们</text>
      <view class="modal-close" bindtap="hideAbout">×</view>
    </view>
    
    <view class="modal-body">
      <view class="app-logo">
        <text class="logo-icon">😄</text>
        <text class="app-name">AI冷笑话生成器</text>
        <text class="app-version">v{{appInfo.version}}</text>
      </view>
      
      <view class="app-description">
        <text class="desc-text">
          AI冷笑话生成器是一款基于人工智能技术的趣味应用，
          能够生成各种类型的冷笑话，为您的生活增添乐趣。
        </text>
      </view>
      
      <view class="app-features">
        <text class="features-title">主要功能</text>
        <view class="feature-list">
          <text class="feature-item">• 智能生成多种类型笑话</text>
          <text class="feature-item">• 个性化偏好设置</text>
          <text class="feature-item">• 收藏和历史记录</text>
          <text class="feature-item">• 一键分享功能</text>
        </view>
      </view>
      
      <view class="app-info">
        <view class="info-item">
          <text class="info-label">开发团队：</text>
          <text class="info-value">{{appInfo.developer}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">构建时间：</text>
          <text class="info-value">{{appInfo.buildTime}}</text>
        </view>
      </view>
    </view>
  </view>
</view>